
<!doctype html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8">
    <meta name="keywords" content="" />
    <meta name="author" content="台灣電力公司" />
    <meta name="copyright" content="台灣電力公司" />
    <meta name="robots" content="all" />
    <meta name="distribution" content="global" />
    <meta name="revisit-after" content="3 days" />
    <meta name="rating" content="general" />
    <meta name="description" content="" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--手機預設圖-->
    <!--link rel="apple-touch-icon" href="../images/apple-touch-icon.png">
    <!--網頁標籤title ico-->
    <!--link rel="shortcut icon" href="../images/logoicon.png">
    <!--icon圖形文字樣式-->
    <!--link rel="stylesheet" href="images/font/typicons.min.css" /-->
    <title>各縣市歷年再生能源裝置容量 - 台灣電力股份有限公司</title>
    <link rel="stylesheet" type="text/css" href="css/chart.css" />
    <link rel="stylesheet" type="text/css" href="css/new17.css">
    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-NQRN439');</script>
    <!-- End Google Tag Manager -->
    <script src="js/jquery/1.12.4/jquery.min.js"></script>
    <!--amchart-->
    <script src="js/amcharts/3.21.13/amcharts.js"></script>
    <script src="js/amcharts/3.21.13/serial.js"></script>
    <script src="js/amcharts/3.21.13/pie.js"></script>
    <script src="js/amcharts/3.21.13/themes/light.js"></script>
    <script src="js/amcharts/3.21.13/plugins/dataloader/dataloader.min.js"></script>
    <script src="js/ammap/3.21.13/ammap.js"></script>
    <!--<script src="js/ammap/3.21.13/maps/svg/taiwanHigh.svg"></script>-->
    <script src="js/ammap/3.21.13/maps/svg/taiwanHigh.svg"></script>
</head>

    <body>
		<div class="chart_main_box">
            <div class="chart_box_info">
                <style type="text/css">
                    @media only screen and (max-width: 560px) {
                        #bar_block {
                            //display:none;
                            width: 100% !important;
                            margin-left: 0px !important;
                            height: 360px !important;
                        }
                        #chartdiv_map {
                            position: absolute;
                            width: 60% !important;
                            right: 0px;
                            bottom: 60px;
                            height: 240px !important;
                        }
                        #map_balloon {
                            top: 136px !important;
                            right: 0% !important;
                        }
                    }
                </style>
                <div class="chartbox_r">
                    <div class="chartbox" style=" max-width:560px;">

                        <div class="chart_r" id="chartblock_1a">
                            <div style="width: 100%; height: 26px; font-size: 13px; margin: 10px 0; text-align:right; line-height:24px;">
                                請選擇：
                                <select id="selectYear" style="margin-right:4px;">
                                    <option value="112">112年</option>
                                    <option value="111">111年</option>
                                    <option value="110">110年</option>                                
                                    <option value="109">109年</option>
                                    <option value="108">108年</option>
                                    <option value="107">107年</option>
                                    <option value="106">106年</option>
                                    <option value="105">105年</option>
                                    <option value="104">104年</option>
                                </select>
                                <select id="selectType" style="margin-right:4px;">
                                    <option value="0">合計</option>
                                    <option value="1">太陽光電</option>
                                    <option value="2">風力</option>
                                    <option value="3">其他(含水力)</option>
                                </select>
                            </div>
                            <div class="charttitle"><span id="selectYearTitle"></span><span id="selectTypeTitle">再生能源</span>裝置容量各縣市分布</div>
                            <div class="chartnote">單位：瓩</div>
                            <div class="chartdiv" style="height:480px; width:100%;position:relative;">
                                <div id="chartdiv_map" style="height:420px; width:56%; float:left;"></div>
                                <div id="bar_block" class="chartdiv" style="height:420px; width:40%; margin-left:3%; float:left; position:relative;">
                                    <div id="chartdiv_bar" style="height:420px; width:100%;"></div>
                                </div>
                                <div id="map_balloon" style="position: absolute; top: 10px; right: 360px; width:130px; background-color: #FFFFFF; box-shadow:rgba(0,0,0,0.1) 0px 2px 2px; padding: 0 4px; border:solid 1px #efefef; display:none;"></div>
                            </div>
                            <div class="chartnote">
                                備註：
                                <ol>
                                    <li>將滑鼠游標移至圖上，可提示游標所在縣市再生能源裝置容量之數據。</li>
                                    <li>再生能源發展條例係於98年7月8日公告施行。</li>
                                    <li>資料含台電公司自有機組裝置容量；購入資料係採計併聯機組之裝置容量。</li>
                                    <li>
                                        風力及太陽光電以外能源〔如水力(包括水庫電廠)、生質能等〕之裝置容量，皆歸於其他(含水力)項目內；惟不含適用汽電共生實施辦法收購之沼氣及垃圾之機組裝置容量(62.2萬瓩)。
                                    </li>
                                </ol>
                            </div>

                        </div>
                        <div class="chart_r" style="clear:both;">
                        </div>
                        <div class="download_list">
                            <ul>
                                <li>
                                    <!--update-->
                                    <a class="blocklink" title="歷年各縣市再生能源裝置容量 (CSV)" target="_blank" href="data/歷年各縣市再生能源裝置容量(101-11210).csv">
                                        <span style="color: black;">檔案下載：</span>歷年各縣市再生能源裝置容量 (CSV)
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div><!--chartbox-->


                <script type="text/javascript">



                    /*update*/
                    AmCharts.loadFile('data/歷年各縣市再生能源裝置容量(101-11210).csv', {}, function (response) {
                        //parse CSV
                        var data0 = AmCharts.parseCSV(response, {
                            "useColumnNames": true
                        });
                        var mapID = [{ 縣市: "基隆市", id: "TW-KEE" }, { 縣市: "台北市", id: "TW-TPE" }, { 縣市: "新北市", id: "TW-TPQ" }, { 縣市: "桃園市", id: "TW-TAO" }, { 縣市: "新竹市", id: "TW-HSQ" }, { 縣市: "新竹縣", id: "TW-HSZ" }, { 縣市: "苗栗縣", id: "TW-MIA" }, { 縣市: "台中市", id: "TW-TXQ" }, { 縣市: "彰化縣", id: "TW-CHA" }, { 縣市: "南投縣", id: "TW-NAN" }, { 縣市: "雲林縣", id: "TW-YUN" }, { 縣市: "嘉義市", id: "TW-CYI" }, { 縣市: "嘉義縣", id: "TW-CYQ" }, { 縣市: "台南市", id: "TW-TNQ" }, { 縣市: "高雄市", id: "TW-KHQ" }, { 縣市: "屏東縣", id: "TW-PIF" }, { 縣市: "宜蘭縣", id: "TW-ILA" }, { 縣市: "花蓮縣", id: "TW-HUA" }, { 縣市: "台東縣", id: "TW-TTT" }, { 縣市: "澎湖縣", id: "TW-PEN" }, { 縣市: "金門縣", id: "TW-1676511" }, { 縣市: "連江縣", id: "TW-6724655" }];
                        /*update_y*/
                        var data = getYearData(112);
                        document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                        function getYearData(y) {
                            var data = [];
                            for (i = 0; i < data0.length - 1; i++) {
                                if (data0[i]["年別"].substr(0, 3) == y) {
                                data.push({
                                    年別: data0[i]["年別"], 縣市: data0[i]["縣市"], 太陽光電: Number(data0[i]["太陽光電"]), 風力: Number(data0[i]["風力"]), 其他含水力: Number(data0[i]["其他(含水力)"]), 合計: Number(data0[i]["太陽光電"]) + Number(data0[i]["風力"]) + Number(data0[i]["其他(含水力)"])
                                });
                                }
                            }               
                            return data;
                        }
                        function getYearTitle(y) {
                            if (y.length > 3) {
                                return y.substr(0, 3) + "年" + y.substr(3, 2) + "月";
                            } else {
                                return y.substr(0, 3) + "年";
                            }
                        }

                        var mapData = getMapData(0);

                        function getMapID(x) {
                            for (i = 0; i <= mapID.length-1; i++) {
                                if (x == mapID[i].縣市) {
                                    return mapID[i].id;
                                } 
                            }
                        }



                        function getMapData(t) {
                            var mapData = [];
                            if (t) {
                            } else {
                                t = "0";
                            }
                            switch (t) {
                                case "0"://再生能源
                                    for (i = 0; i <= data.length - 1; i++) {
                                        if (data[i]["合計"] > 0) {
                                            mapData.push({
                                                id: getMapID(data[i]["縣市"]), name: data[i]["縣市"], value: data[i]["合計"], title: data[i]["縣市"]
                                            });
                                        }
                                    }
                                    break;
                                case "1"://太陽能
                                    for (i = 0; i <= data.length - 1; i++) {
                                        if (data[i]["太陽光電"] > 0) {
                                        mapData.push({
                                            id: getMapID(data[i]["縣市"]), name: data[i]["縣市"], value: data[i]["太陽光電"], title: data[i]["縣市"]
                                            });
                                        }
                                    }
                                    break;
                                case "2"://風力
                                    for (i = 0; i <= data.length - 1; i++) {
                                        if (data[i]["風力"] > 0) {
                                            mapData.push({
                                                id: getMapID(data[i]["縣市"]), name: data[i]["縣市"], value: data[i]["風力"], title: data[i]["縣市"]
                                            });
                                        }
                                    }
                                    break;
                                case "3"://其他(含水力)
                                    for (i = 0; i <= data.length - 1; i++) {
                                        if (data[i]["其他含水力"] > 0) {
                                            mapData.push({
                                                id: getMapID(data[i]["縣市"]), name: data[i]["縣市"], value: data[i]["其他含水力"], title: data[i]["縣市"]
                                            });
                                        }
                                    }
                                    break;
                            }
                            return mapData;
                        }

                        var map = AmCharts.makeChart("chartdiv_map", {
                            "type": "map",
                            "theme": "none",
                            "dragMap": false,
                            "zoomOnDoubleClick": false,
                            "zoomControl": {
                                "panControlEnabled": false,
                                "zoomControlEnabled": false,
                                "homeButtonEnabled": false,
                            },
                            "areasSettings": {
                                "autoZoom": false,
                                "color": "#d2e7d2",
                                "colorSolid": "#228b22",
                                "outlineAlpha": 0.8,
                                "outlineColor": "#FFFFFF",
                                "unlistedAreasColor": "#e7e7e7",
                                "rollOverColor": "#757575",
                                "rollOverOutlineColor": "#FFFFFF",
                                //"rollOverOutlineThickness": 2,
                                //"balloonText": "[[title]]: <strong>[[value]]</strong>  [[percent]]瓩"
                            },
                            "colorSteps": 7,
                            "dataProvider": {
                                //"map": "taiwanHigh",
                                "mapURL": "js/ammap/3.21.13/maps/svg/taiwanHigh.svg",
                                "areas": mapData,
                            },
                            "valueLegend": {
                                "right": 10,
                                "minValue": "",
                                "maxValue": "瓩",
                                "color": "#666666",
                                "enabled": false,
                                //"showAsGradient":true,
                            },
                            "balloon": {
                                "enabled": false,
                            },

                        })

                        //Map 和 BarChart hover連動
                        map.addListener("rollOverMapObject", function (event) {
                            document.getElementById('map_balloon').innerHTML = "<table style='font-size:11px; line-height:20px; font-family: Microsoft JhengHei; text-align:left;'><tr> <td>" + event.mapObject.title + "<br>" + event.mapObject.value + " 瓩</td ></tr ></table >";
                            chart.chartCursor.showCursorAt(event.mapObject.name);
                        });
                        map.addListener("rollOutMapObject", function (event) {
                            document.getElementById('map_balloon').style.display = "none";
                            chart.chartCursor.hideCursor();
                        });




                        var columnData = getColumnData();

                        map.addListener("rendered", function () {
                            columnData = getColumnData();
                            chart.dataProvider = columnData;
                        });
                        function getColumnData() {
                            var columnData2 = [];
                            for (i = 0; i <= data.length - 1; i++) {

                                if (map.getObjectById(mapID[i]["id"])) {
                                    columnData2.push({ 縣市: data[i]["縣市"], color: map.getObjectById(mapID[i]["id"]).colorReal, 風力: data[i]["風力"], 太陽光電: data[i]["太陽光電"], 其他含水力: data[i]["其他含水力"], 合計: data[i]["合計"] });
                                } else {
                                    columnData2.push({ 縣市: "", color: "", 風力: "", 太陽光電: "", 其他含水力: "", 合計: "" });
                                }
                            }
                            return columnData2;
                        }
                        //Bar Chart
                        //sort data
                        AmCharts.addInitHandler(function (chart) {
                            sortData(chart);
                        }, ["serial"]);
                        
                        //sortData(chart);
                        
                        var chart = AmCharts.makeChart("chartdiv_bar", {
                            "type": "serial",
                            "theme": "light",
                            "dataProvider": columnData,
                            "orderByField": "合計",
                            "autoMargins": false,
                            "marginTop": 36,
                            "marginRight": 28,
                            "marginBottom": 0,
                            "marginLeft": 44,
                            "rotate": true,
                            "valueAxes": [{
                                "id": "v1",
                                "position": "top",
                                "color": "#808080",
                                "gridColor": "#666666",
                                "gridAlpha": 0.1,
                                "tickLength": 0,
                                "axisThickness": 0,
                                "strictMinMax": true,
                                "minimum": 0,
                                "maximum": 3000000,
                                "fontSize": 10,
                                //"labelsEnabled": false,
                                /*"labelFunction": function (value) {
                                    return parseInt(value).toLocaleString();
                                },*/
                                "stackType": "regular",
                                //"showFirstLabel": false,
                            }],
                            "graphs": [{
                                "id": "g1",
                                "valueAxis": "v1",
                                "title": "太陽光電",
                                "valueField": "",
                                "colorField": "color",
                                //"type": "line",
                                "type": "column",
                                "columnWidth": 0.75,
                                //"showBalloon": false,
                                //"balloonText": "<span style='padding:5px; color:#666666;'>[[value]] 瓩</span>",
                                "balloonFunction": function (event) {
                                    if (columnData[event.index]["太陽光電"] == 0) {
                                        return "";
                                    } else {
                                        return "<table style='font-size:10px; color:#666; font-family: Microsoft JhengHei; padding:0px 0px 0px 4px;'><tr><td><span style='color:#666; font-size:11px; font-weight:900;'>" + columnData[event.index]["太陽光電"].toFixed() + " </span>瓩</td></tr ></table>";
                                    }
                                },
                                "lineAlpha": 0.8,
                                "lineThickness": 0,
                                "fillAlphas": 1,
                                "fillColors": "#ffa500",
                                "bullet": "round",
                                "bulletAlpha": 0,
                                "bulletSize": 6,
                                "bulletBorderAlpha": 0,
                                "bulletBorderThickness": 0,

                                }, {
                                "id": "g2",
                                "valueAxis": "v1",
                                "title": "風力",
                                "valueField": "",
                                "colorField": "color",
                                //"type": "line",
                                "type": "column",
                                "columnWidth": 0.75,
                                //"showBalloon": false,
                                //"balloonText": "<span style='padding:5px; color:#666666;'>[[value]] 瓩</span>",
                                "balloonFunction": function (event) {
                                    if (columnData[event.index]["風力"] == 0) {
                                        return "";
                                    } else {
                                        return "<table style='font-size:10px; color:#666; font-family: Microsoft JhengHei; padding:0px 0px 0px 4px;'><tr><td><span style='color:#666; font-size:11px; font-weight:900;'>" + columnData[event.index]["風力"].toFixed() + " </span>瓩</td></tr ></table>";
                                    }
                                },
                                "lineAlpha": 0.8,
                                "lineThickness": 0,
                                "fillAlphas": 1,
                                "fillColors": "#228b22",
                                "bullet": "round",
                                "bulletAlpha": 0,
                                "bulletSize": 6,
                                "bulletBorderAlpha": 0,
                                "bulletBorderThickness": 0,
                                }, {
                                    "id": "g3",
                                    "valueAxis": "v1",
                                    "title": "其他(含水力)",
                                    "valueField": "",
                                    "colorField": "color",
                                    //"type": "line",
                                    "type": "column",
                                    "columnWidth": 0.75,
                                    //"showBalloon": false,
                                    //"balloonText": "<span style='padding:5px; color:#666666;'>[[value]] 瓩</span>",
                                    "balloonFunction": function (event) {
                                        if (columnData[event.index]["其他含水力"] == 0) {
                                            return "";
                                        } else {
                                            return "<table style='font-size:10px; color:#666; font-family: Microsoft JhengHei; padding:0px 0px 0px 4px;'><tr><td><span style='color:#666; font-size:11px; font-weight:900;'>" + columnData[event.index]["其他含水力"].toFixed() + " </span>瓩</td></tr></table>";
                                        }
                                    },
                                    "lineAlpha": 0.8,
                                    "lineThickness": 0,
                                    "fillAlphas": 1,
                                    "fillColors": "#4169e1",
                                    "bullet": "round",
                                    "bulletAlpha": 0,
                                    "bulletSize": 6,
                                    "bulletBorderAlpha": 0,
                                    "bulletBorderThickness": 0,
                                }, {
                                    "id": "g4",
                                    "valueAxis": "v1",
                                    "title": "合計",
                                    "valueField": "合計",
                                    "colorField": "color",
                                    //"type": "line",
                                    "type": "column",
                                    "columnWidth": 0.75,
                                    //"showBalloon": false,
                                    //"balloonText": "<span style='padding:5px; color:#666666;'>[[value]] 瓩</span>",
                                    "balloonFunction": function (event) {
                                        if (columnData[event.index]["合計"] == 0) {
                                            return "";
                                        } else {
                                            return "<table style='font-size:10px; color:#666; font-family: Microsoft JhengHei; padding:0px 0px 0px 4px;'><tr><td><span style='color:#666; font-size:11px; font-weight:900;'>" + columnData[event.index]["合計"].toFixed() + " </span>瓩</td></tr></table>";
                                        }
                                    },
                                    "lineAlpha": 0.8,
                                    "lineThickness": 0,
                                    "fillAlphas": 1,
                                    "fillColors": "#228b22",
                                    "bullet": "round",
                                    "bulletAlpha": 0,
                                    "bulletSize": 6,
                                    "bulletBorderAlpha": 0,
                                    "bulletBorderThickness": 0,
                            }],

                            "categoryField": "縣市",
                            "categoryAxis": {
                                "color": "#666666",
                                "autoGridCount": false,
                                "axisAlpha": 0,
                                "labelOffset": -5,
                                "tickLength": 3,
                                "gridCount": 50,
                                "gridAlpha": 0,
                                "labelFrequency": 1,
                                "fontSize":11,
                            },                                              
                            "balloon": {
                                /*"adjustBorderColor":false,*/
                                "color": "#000000",
                                "cornerRadius": 2,
                                "fillAlpha": 1,
                                "fillColor": "#FFFFFF",
                                "borderAlpha": 0.5,
                                "borderThickness": 1.5,
                                "shadowAlpha": 0.4,
                                "shadowColor": "#666666",
                                "verticalPadding": 0,
                                "horizontalPadding": 0,
                                "fontSize": 11,
                                //"enabled":false,
                            },
                            "chartCursor": {
                                "zoomable": false,
                                "categoryBalloonColor": "#666666",
                                "categoryBalloonText": "[[category]]",
                                //"balloonPointerOrientation": "vertical",
                                "balloonPointerOrientation": "horizontal",
                                "showNextAvailable": true,
                                "fullWidth": true,
                                "cursorAlpha": 0.05,
                                "listeners": [{ "event": "changed", "method": handleCursorChange }], 
                            },
                            "legend": {
                                "enabled": false,
                            },
                        });

                        document.getElementById("selectType").onchange = function () { selectType(this.options[this.selectedIndex].value) };

                        //BarChart 和 Map hover連動
                        function handleCursorChange(event) {
                            var index = event.index;
                            var dataItem = event.chart.dataProvider[index];
                            
                            if (dataItem) {
                                var county = dataItem.縣市;
                                var areas = map.dataProvider.areas;
                                for (var i = 0; i < areas.length; i++) {
                                    var area = areas[i];
                                    if (area.name == county) {
                                        map.rollOverMapObject(area);
                                    } 
                                }
                            }
                        }
                        function sortData (chart) {
                            chart.dataProvider.sort(function (a, b) {
                                if (Number(a[chart.orderByField]) > Number(b[chart.orderByField])) {
                                    return -1;
                                } else if (Number(a[chart.orderByField]) == Number(b[chart.orderByField])) {
                                    return 0;
                                }
                                return 1;
                            });
                        }

                        function selectType(x) {
                            if (x) {
                            } else {
                                x = "0";
                            }
                            switch (x) {
                                case "0"://再生能源合計
                                    document.getElementById("selectTypeTitle").innerHTML = "再生能源";
                                    mapData = getMapData("0");
                                    map.dataProvider.areas = mapData;
                                    map.areasSettings.color = "#d2e7d2";
                                    map.areasSettings.colorSolid = "#228b22";
                                    map.validateNow(true);                                
                                    chart.graphs[0].valueField = "";
                                    chart.graphs[1].valueField = "";
                                    chart.graphs[2].valueField = "";
                                    chart.graphs[3].valueField = "合計";
                                    chart.orderByField = "合計";
                                    chart.valueAxes[0].maximum = 3000000;
                                    sortData(chart);
                                    chart.validateData();
                                    document.getElementById('map_balloon').style.display = "none";
                                    break;
                                case "1"://太陽能
                                    document.getElementById("selectTypeTitle").innerHTML = "太陽光電";
                                    mapData = getMapData("1");
                                    map.dataProvider.areas = mapData;
                                    map.areasSettings.color = "#ffedcc";
                                    map.areasSettings.colorSolid = "#ffa500";
                                    map.validateNow(true);
                                    chart.graphs[0].valueField = "太陽光電";
                                    chart.graphs[1].valueField = "";
                                    chart.graphs[2].valueField = "";
                                    chart.graphs[3].valueField = "";
                                    chart.orderByField = "太陽光電";
                                    chart.valueAxes[0].maximum = 2400000;
                                    sortData(chart);
                                    chart.validateData();
                                    document.getElementById('map_balloon').style.display = "none";
                                    break;
                                case "2"://風力
                                    document.getElementById("selectTypeTitle").innerHTML = "風力";
                                    mapData = getMapData("2");
                                    map.dataProvider.areas = mapData;
                                    map.areasSettings.color = "#d5e7dd";
                                    map.areasSettings.colorSolid = "#2E8B57";
                                    map.validateNow(true);
                                    chart.graphs[0].valueField = "";
                                    chart.graphs[1].valueField = "風力";
                                    chart.graphs[2].valueField = "";
                                    chart.graphs[3].valueField = "";
                                    chart.orderByField = "風力";
                                    chart.valueAxes[0].maximum = 1300000;;
                                    sortData(chart);
                                    chart.validateData();
                                    document.getElementById('map_balloon').style.display = "none";
                                    break;
                                case "3"://其他(含水力)
                                    document.getElementById("selectTypeTitle").innerHTML = "其他再生能源(含水力)";
                                    mapData = getMapData("3");
                                    map.dataProvider.areas = mapData;
                                    map.areasSettings.color = "#d9e1f9";
                                    map.areasSettings.colorSolid = "#4169e1";
                                    map.validateNow(true);
                                    chart.graphs[0].valueField = "";
                                    chart.graphs[1].valueField = "";
                                    chart.graphs[2].valueField = "其他含水力";
                                    chart.graphs[3].valueField = "";
                                    chart.orderByField = "其他含水力";
                                    chart.valueAxes[0].maximum = 1300000;
                                    sortData(chart);
                                    chart.validateData();
                                    document.getElementById('map_balloon').style.display = "none";
                                    break;
                            }
                        }

                        document.getElementById("selectYear").onchange = function () { selectYear(this.options[this.selectedIndex].value) };

                        function selectYear(x) {
                            var typeIndex = document.getElementById("selectType").value;  
                            if (x) {
                            } else {
                                /*update_y*/
                                x = "112";
                            }
                            switch (x) {
                                /*update_y*/
                                case "112"://110
                                    data = getYearData(112);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;
                                case "111"://110
                                    data = getYearData(111);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;
                                case "110"://110
                                    data = getYearData(110);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;

                                case "109"://109
                                    data = getYearData(109);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;

                                case "108"://108
                                    data = getYearData(108);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;

                                case "107"://107
                                    data = getYearData(107);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;

                                case "106"://106                            
                                    data = getYearData(106);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);                                    
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;
                                case "105"://105
                                    data = getYearData(105);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;
                                case "104"://其他(含水力)
                                    data = getYearData(104);
                                    document.getElementById("selectYearTitle").innerHTML = getYearTitle(data[0]["年別"]);
                                    mapData = getMapData(typeIndex);
                                    map.dataProvider.areas = mapData;
                                    map.validateNow(true);
                                    sortData(chart);
                                    chart.validateData();
                                    break;
                            }
                        }

                    });

                </script>


            </div>
			<!--資料區塊 結束-->
		</div>
    </body>
</html>